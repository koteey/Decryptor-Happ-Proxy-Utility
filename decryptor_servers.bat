@echo off
setlocal enabledelayedexpansion
chcp 65001 >nul
title HAPP ULTIMATE DECRYPTOR

:START
cls
echo ==================================================
echo   üõ† –ü–û–õ–ù–´–ô –ü–ï–†–ï–ó–ê–ü–£–°–ö (–í–∫–ª—é—á–∞—è frida.bat)
echo ==================================================

:: 1. –£–±–∏–≤–∞–µ–º —Å—Ç–∞—Ä—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ —á–µ—Ä–µ–∑ ADB –Ω–∞–ø—Ä—è–º—É—é, 
:: —á—Ç–æ–±—ã frida.bat –∑–∞–ø—É—Å–∫–∞–ª—Å—è –Ω–∞ "—á–∏—Å—Ç—É—é" –ø–æ—á–≤—É
echo [*] –ß–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Ö–≤–æ—Å—Ç–æ–≤ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ...
adb shell "su -c 'pkill -9 frida-server'" >nul 2>&1
adb shell "su -c 'pkill -9 com.happproxy'" >nul 2>&1

:: 2. –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–≤–æ–π –±–∞—Ç–Ω–∏–∫ —Å–µ—Ä–≤–µ—Ä–∞
echo [*] –ó–∞–ø—É—Å–∫–∞—é —Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ —Ç–≤–æ–π frida.bat...
:: –ò—Å–ø–æ–ª—å–∑—É–µ–º /c —á—Ç–æ–±—ã –æ–Ω –æ—Ç—Ä–∞–±–æ—Ç–∞–ª –∏ –≤–µ—Ä–Ω—É–ª —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –ª–∏–±–æ –ø—Ä–æ—Å—Ç–æ start
start "" frida.bat

echo [*] –ñ–¥—É 5 —Å–µ–∫—É–Ω–¥ –¥–ª—è —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞...
timeout /t 5 >nul

:: 3. –ñ–¥–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
echo [*] –û—Ç–∫—Ä–æ–π/–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ HappProxy –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ...
:WAIT_FOR_PID
for /f "tokens=2" %%a in ('adb shell "ps -A | grep com.happproxy | grep -v :XRayDaemon | grep -v :bg_process"') do (
    set PID=%%a
)
if "%PID%"=="" (
    timeout /t 1 >nul
    goto WAIT_FOR_PID
)

echo [‚úÖ] –ü—Ä–æ—Ü–µ—Å—Å –Ω–∞–π–¥–µ–Ω! PID: %PID%
echo [*] –ò–Ω–∂–µ–∫—Ç–∏—Ä—É—é Mega-Hook... 
echo --------------------------------------------------

:: –ó–∞–ø—É—Å–∫ —Å–∞–º–æ–π —Ñ—Ä–∏–¥—ã
frida.exe -U -p %PID% -l happ_final.js

echo --------------------------------------------------
echo [!] –°–µ—Å—Å–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞.
pause
goto START